<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Creator Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <a href="{{ url_for('creator_profile', creator_id=session['user_id']) }}" class="btn btn-outline-primary">My Profile</a>

<div class="container my-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Creator Dashboard</h2>
    
    <a href="/logout" class="btn btn-outline-danger">Logout</a>
  </div>

  <!-- Post Idea Form -->
  <div class="card mb-4">
    <div class="card-body">
      <h4 class="card-title">Post a New Idea</h4>
      <form method="POST">
        <div class="mb-3">
          <input name="title" type="text" class="form-control" placeholder="Idea Title" required>
        </div>
        <div class="mb-3">
          <textarea name="description" class="form-control" placeholder="Idea Description" rows="4" required></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Post Idea</button>
      </form>
    </div>
  </div>

  <!-- Your Ideas -->
<div class="mb-4">
  <h4>Your Ideas</h4>
  <ul class="list-group">
    {% for idea in ideas %}
      <li class="list-group-item">
        <div class="d-flex align-items-start">
          <!-- Profile Picture -->
          {% if idea.creator.profile_pic %}
            <img src="{{ url_for('static', filename='uploads/' + idea.creator.profile_pic) }}" width="50" height="50" class="rounded-circle me-3">
          {% else %}
            <div class="me-3">
              <span class="badge bg-secondary rounded-circle p-3">?</span>
            </div>
          {% endif %}

          <div>
            <!-- Idea Details -->
            <strong>{{ idea.title }}</strong><br>
            <small class="text-muted">{{ idea.description }}</small><br>
            <small>By: <a href="{{ url_for('creator_profile', creator_id=idea.creator.id) }}">{{ idea.creator.username }}</a></small><br>

            <!-- Like count (read-only for creator) -->
            <small>üëç Likes: {{ idea.likes|length }}</small>
          </div>
        </div>
      </li>
    {% endfor %}
  </ul>
</div>



  <!-- Collaboration Requests -->
  <div>
    <h4>Collaboration Requests</h4>
    <ul class="list-group">
      {% for r in requests %}
        {% if r.idea.creator_id == session['user_id'] %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <strong>Company ID:</strong> {{ r.company_id }}<br>
              Requested on idea: <strong>{{ r.idea.title }}</strong>
            </div>
            <div class="d-flex gap-2">
              {% if r.accepted %}
                <span class="badge bg-success">‚úÖ Accepted</span>
              {% else %}
                <a href="/creator/accept/{{ r.id }}" class="btn btn-sm btn-outline-primary">Accept</a>
              {% endif %}
              <!-- Chat with Company button -->
              <a href="{{ url_for('chat', user_id=r.company_id) }}" class="btn btn-sm btn-outline-success">Chat with Company</a>
            </div>
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  </div>
</div>

</body>
</html>
